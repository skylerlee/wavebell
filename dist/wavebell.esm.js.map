{"version":3,"file":"wavebell.esm.js","sources":["../lib/util/emitter.js","../lib/util/assert.js","../lib/media/audio_filter.js","../lib/media/volume_meter.js","../lib/util/props.js","../lib/media/user_media.js","../lib/media/recorder.js","../lib/wavebell.js"],"sourcesContent":["/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nfunction slice (args, from) {\n  return Array.prototype.slice.call(args, from)\n}\n\nclass Emitter {\n  constructor () {\n    this.handlerMap = {}\n  }\n\n  on (event, handler) {\n    if (typeof event !== 'string') {\n      throw new TypeError(event + ' is not a string')\n    }\n    if (typeof handler !== 'function') {\n      throw new TypeError(handler + ' is not a function')\n    }\n    let map = this.handlerMap\n    let handlers = map[event] = map[event] || []\n    let i = handlers.indexOf(handler)\n    if (i === -1) {\n      handlers.push(handler)\n    }\n    return this\n  }\n\n  off (event, handler) {\n    if (handler === undefined) {\n      // remove all handlers\n      delete this.handlerMap[event]\n      return this\n    }\n    // remove registered handler\n    let handlers = this.handlerMap[event]\n    if (handlers) {\n      let i = handlers.indexOf(handler)\n      if (i >= 0) {\n        handlers.splice(i, 1)\n      }\n      // cleanup empty handlers\n      if (handlers.length === 0) {\n        this.off(event)\n      }\n    }\n    return this\n  }\n\n  emit (event) {\n    let args = slice(arguments, 1)\n    let handlers = this.handlerMap[event]\n    if (handlers) {\n      for (let i = 0, len = handlers.length; i < len; i++) {\n        handlers[i].apply(undefined, args)\n      }\n    }\n    return this\n  }\n}\n\nexport default Emitter\n","/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nclass Assertion {\n  constructor (value) {\n    this.value = value\n    this._negative = false\n    this._error = new Error('Assertion failed')\n  }\n\n  get to () {\n    return this\n  }\n\n  get not () {\n    this._negative = !this._negative\n    return this\n  }\n\n  that (error) {\n    this._error = error\n    return this\n  }\n\n  equal (value) {\n    if ((value === this.value) === this._negative) {\n      throw this._error\n    }\n  }\n}\n\nfunction assert (value) {\n  return new Assertion(value)\n}\n\nexport default assert\n","/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nconst AudioContext = window.AudioContext || window.webkitAudioContext\n\n// AudioContext singleton shared by filters\nlet audioContext = null\n\nclass AudioFilter {\n  /**\n   * Get AudioContext instance\n   * @returns {AudioContext} - Shared instance\n   */\n  get context () {\n    if (!audioContext) {\n      audioContext = new AudioContext()\n    }\n    return audioContext\n  }\n}\n\nexport default AudioFilter\n","/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nimport AudioFilter from './audio_filter'\n\nclass VolumeMeter extends AudioFilter {\n  constructor (mainbus, options) {\n    super()\n    this.mainbus = mainbus\n    this.options = Object.assign({\n      minLimit: 0,\n      maxLimit: 128,\n      fftSize: 1024,\n      smoothing: 0.3\n    }, options)\n    this._checkOptions(this.options)\n    this.source = null\n    this.analyser = this._initAnalyser(this.options)\n  }\n\n  _checkOptions (options) {\n    if (options.maxLimit <= options.minLimit) {\n      throw new RangeError('Wrong limit range for volume')\n    }\n  }\n\n  _initAnalyser (options) {\n    // init analyser from options\n    /// ref: https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode\n    let analyser = this.context.createAnalyser()\n    analyser.fftSize = options.fftSize\n    analyser.smoothingTimeConstant = options.smoothing\n    // process data when available\n    this.mainbus.on('dataavailable', e => this._processData())\n    return analyser\n  }\n\n  pipe (stream) {\n    // connect stream pipe\n    this.source = this.context.createMediaStreamSource(stream)\n    this.source.connect(this.analyser)\n    this.analyser.connect(this.context.destination)\n  }\n\n  cutoff () {\n    this.analyser.disconnect(this.context.destination)\n    this.source.disconnect(this.analyser)\n    this.source = null\n  }\n\n  _processData () {\n    // half of the fftSize\n    let data = new Uint8Array(this.analyser.frequencyBinCount)\n    this.analyser.getByteFrequencyData(data)\n    let volume = this._calcAvgVolume(data)\n    this.mainbus.emit('wave', {\n      value: this._alignVolume(volume)\n    })\n  }\n\n  _alignVolume (volume) {\n    let opts = this.options\n    if (volume < opts.minLimit) {\n      volume = opts.minLimit\n    }\n    if (volume > opts.maxLimit) {\n      volume = opts.maxLimit\n    }\n    return (volume - opts.minLimit) / (opts.maxLimit - opts.minLimit)\n  }\n\n  _calcAvgVolume (data) {\n    let sum = 0\n    let len = data.length\n    for (let i = 0; i < len; i++) {\n      sum += data[i]\n    }\n    return sum / len\n  }\n}\n\nexport default VolumeMeter\n","/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nconst hasOwn = Object.prototype.hasOwnProperty\n\nclass PropPath {\n  constructor (path) {\n    this.steps = path.split('.')\n    this.fallback = undefined\n  }\n\n  travel (target, fn) {\n    if (typeof fn !== 'function') {\n      throw new TypeError(fn + ' is not a function')\n    }\n    let len = this.steps.length\n    let i = 0\n    let step = this.steps[i]\n    while (fn(target, step) && i < len) {\n      target = target[step]\n      step = this.steps[++i]\n    }\n    return {\n      step: i,\n      value: target\n    }\n  }\n\n  or (defaultValue) {\n    this.fallback = defaultValue\n    return this\n  }\n\n  from (obj) {\n    let ret = this.travel(obj, (target, step) => {\n      return target != null && step in Object(target)\n    })\n    if (ret.step === this.steps.length) {\n      return ret.value\n    } else {\n      return this.fallback\n    }\n  }\n\n  hadBy (obj) {\n    let ret = this.travel(obj, (target, step) => {\n      return target != null && step in Object(target)\n    })\n    return ret.step === this.steps.length\n  }\n\n  ownedBy (obj) {\n    let ret = this.travel(obj, (target, step) => {\n      return target != null && hasOwn.call(target, step)\n    })\n    return ret.step === this.steps.length\n  }\n}\n\nfunction props (path) {\n  if (typeof path !== 'string') {\n    throw new TypeError(path + ' is not a string')\n  }\n  return new PropPath(path)\n}\n\nexport default props\n","/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nimport props from '@/util/props'\n\n/**\n * Shim for MediaDevices#getUserMedia method\n * @param {object} constraints - The user media constraints\n */\nfunction getUserMedia (constraints) {\n  if (props('navigator.mediaDevices.getUserMedia').hadBy(window)) {\n    let medias = props('navigator.mediaDevices').from(window)\n    return medias.getUserMedia(constraints)\n  }\n  let userMediaGetter = navigator.getUserMedia ||\n                        navigator.webkitGetUserMedia ||\n                        navigator.mozGetUserMedia ||\n                        navigator.msGetUserMedia\n  if (!userMediaGetter) {\n    throw new Error('getUserMedia is not supported by this browser')\n  }\n  return new Promise((resolve, reject) => {\n    userMediaGetter(constraints, resolve, reject)\n  })\n}\n\n/**\n * Access audio input from microphone device\n */\nfunction getUserMicrophone () {\n  return getUserMedia({ audio: true, video: false })\n}\n\nexport {\n  getUserMedia,\n  getUserMicrophone\n}\n","/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nimport Emitter from '@/util/emitter'\nimport assert from '@/util/assert'\nimport VolumeMeter from './volume_meter'\nimport { getUserMicrophone } from './user_media'\n\nfunction buildError (callee, that) {\n  return new Error(`Failed to execute '${callee}' on 'Recorder'` +\n    (that ? `:\\nThe Recorder's state is '${that.state}'.` : ''))\n}\n\nclass Recorder extends Emitter {\n  constructor (options) {\n    super()\n    this.options = Object.assign({\n      mimeType: 'audio/webm',\n      audioBitsPerSecond: 96000\n    }, options)\n    this._intern = null\n    this._result = null\n    this._filter = new VolumeMeter(this, this.options.meter)\n  }\n\n  get state () {\n    if (this._intern === null) {\n      return 'inactive'\n    } else {\n      return this._intern.state\n    }\n  }\n\n  get ready () {\n    return this._intern !== null\n  }\n\n  get result () {\n    if (!this._result) {\n      return null\n    }\n    return new Blob(this._result, {\n      type: this.options.mimeType\n    })\n  }\n\n  open () {\n    assert(this.ready).that(buildError('open')).to.equal(false)\n    return getUserMicrophone().then(stream => {\n      // create internal recorder\n      this._intern = new MediaRecorder(stream, this.options)\n      // register event listeners\n      let eventTypes = ['error', 'pause', 'resume', 'start', 'stop']\n      eventTypes.map(type => {\n        this._intern.addEventListener(type, e => this.emit(type, e))\n      })\n      this._intern.addEventListener('dataavailable', e => {\n        this._result.push(e.data)\n        this.emit('dataavailable', e)\n      })\n      // pipe stream to filter\n      this._filter.pipe(stream)\n    })\n  }\n\n  close () {\n    assert(this.ready).that(buildError('close')).to.equal(true)\n    // close all stream tracks\n    let tracks = this._intern.stream.getTracks()\n    for (let i = 0; i < tracks.length; i++) {\n      tracks[i].stop()\n    }\n    // close stream filter\n    this._filter.cutoff()\n    this._intern = null\n  }\n\n  start (timeslice) {\n    assert(this.state).that(buildError('start', this)).to.equal('inactive')\n    // init result data on every start\n    this._result = []\n    // use lazy open policy\n    if (!this.ready) {\n      this.open().then(() => {\n        this._intern.start(timeslice)\n      })\n    } else {\n      this._intern.start(timeslice)\n    }\n  }\n\n  stop () {\n    assert(this.state).that(buildError('stop', this)).to.not.equal('inactive')\n    this._intern.stop()\n  }\n\n  pause () {\n    assert(this.state).that(buildError('pause', this)).to.equal('recording')\n    this._intern.pause()\n  }\n\n  resume () {\n    assert(this.state).that(buildError('resume', this)).to.equal('paused')\n    this._intern.resume()\n  }\n}\n\nexport default Recorder\n","/*\n * Copyright (C) 2017, Skyler.\n * Use of this source code is governed by the MIT license that can be\n * found in the LICENSE file.\n */\n\nimport Recorder from '@/media/recorder'\n\nclass WaveBell extends Recorder {}\n\nexport default WaveBell\n"],"names":[],"mappings":"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"}